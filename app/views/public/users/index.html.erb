<div class="container">
  <div class="d-flex justify-content-center mb-2">
    <%= render "public/searches/form" %>
  </div>
   <%= render "layouts/flash" %>

    <% if @records %>
      <%= render 'public/searches/index', locals: { users: @records } %>
    <% end %>
  <% if @users.present? %>  
  <div class='row mt-5'> 
    <h3>ユーザー一覧</h3>
    
    <table class="table mt-3">
      <thead>
        <tr>
          <th class="col-2">ユーザー名</th>
          <th class="col-2">作成日</th>
          <th class="col-2">フォロー数</th>
          <th class="col-2">フォロワー数</th>
          <th class="col-2">操作</th>
        </tr>
      </thead>
      <tbody>
        <% @users.each do |user| %>
          <tr>
            <td><%= user.username %></td>
            <td><%= user.created_at.strftime('%Y/%m/%d') %></td>
            <td><%= user.followings.count %></td>
            <td><%= user.followers.count %></td>
            <td>
           <% unless current_user == user %>
            <% if current_user.following?(user) %>
              <%= button_to 'フォロー解除', unfollow_public_user_relationships_path(user_id: user.id), method: :delete, class: 'btn btn-danger'%>
            <% else %>
              <%= button_to 'フォロー', follow_public_user_relationships_path(user_id: user.id), method: :post, class: 'btn btn-primary' %>
            <% end %>
          <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
    <%= paginate @users %>
  <% end %>
  </div>
</div>
